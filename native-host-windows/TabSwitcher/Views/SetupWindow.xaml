<Window x:Class="TabSwitcher.Views.SetupWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Tab Switcher"
        Width="460" Height="580"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Scrollable content -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="24,0">
            <StackPanel Margin="0,16,0,16">

                <!-- Header -->
                <StackPanel HorizontalAlignment="Center" Margin="0,8,0,20">
                    <Image x:Name="AppIcon"
                           Width="64" Height="64"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />
                    <TextBlock Text="Tab Switcher"
                               FontSize="18" FontWeight="Bold"
                               HorizontalAlignment="Center" />
                    <TextBlock x:Name="VersionText"
                               FontSize="11"
                               Foreground="Gray"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <!-- Browsers Section -->
                <TextBlock Text="BROWSERS"
                           FontSize="11" FontWeight="Medium"
                           Foreground="Gray"
                           Margin="4,0,0,8" />

                <Border Background="#0A808080" CornerRadius="10">
                    <ItemsControl x:Name="BrowserList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <!-- Main row -->
                                    <Button Click="BrowserRow_Click"
                                            Tag="{Binding Id}"
                                            Background="Transparent"
                                            BorderThickness="0"
                                            Padding="12,10"
                                            Cursor="Hand"
                                            HorizontalContentAlignment="Stretch">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="32" />
                                                <ColumnDefinition Width="10" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <Image Grid.Column="0"
                                                   Source="{Binding IconPath}"
                                                   Width="32" Height="32" />

                                            <TextBlock Grid.Column="2"
                                                       Text="{Binding DisplayName}"
                                                       FontSize="13"
                                                       VerticalAlignment="Center" />

                                            <TextBlock Grid.Column="3"
                                                       Text="Enabled"
                                                       FontSize="11"
                                                       Foreground="Green"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0"
                                                       Visibility="{Binding IsEnabledVisible}" />

                                            <TextBlock Grid.Column="4"
                                                       Text=">"
                                                       FontSize="11"
                                                       FontWeight="SemiBold"
                                                       Foreground="Gray"
                                                       VerticalAlignment="Center" />
                                        </Grid>
                                    </Button>

                                    <!-- Expanded section -->
                                    <StackPanel x:Name="ExpandedPanel"
                                                Visibility="{Binding ExpandedVisibility}"
                                                Margin="12,0,12,10">

                                        <!-- Enabled state -->
                                        <StackPanel Visibility="{Binding IsEnabledVisible}">
                                            <CheckBox Content="Cycle through all windows"
                                                      IsChecked="{Binding CombineAllWindows}"
                                                      Margin="0,4,0,4"
                                                      FontSize="12"
                                                      Click="CombineWindows_Click"
                                                      Tag="{Binding Id}" />
                                            <TextBlock Text="When off, only tabs from the active window are shown"
                                                       FontSize="10" Foreground="Gray" Margin="20,0,0,8" />
                                            <Button Content="Disable Browser"
                                                    FontSize="11"
                                                    Foreground="Red"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    Click="DisableBrowser_Click"
                                                    Tag="{Binding Id}"
                                                    Cursor="Hand" />
                                        </StackPanel>

                                        <!-- Not enabled state -->
                                        <StackPanel Visibility="{Binding IsNotEnabledVisible}">
                                            <TextBlock FontSize="11" Foreground="Gray"
                                                       Text="{Binding ExtensionIdPrompt}" />
                                            <TextBlock FontSize="10" Foreground="#99808080"
                                                       Text="Extensions > Developer Mode > Copy ID"
                                                       Margin="0,2,0,4" />
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="6" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <TextBox Grid.Column="0"
                                                         x:Name="ExtIdBox"
                                                         FontSize="13"
                                                         Height="26"
                                                         Tag="{Binding Id}"
                                                         TextChanged="ExtId_TextChanged" />
                                                <Button Grid.Column="2"
                                                        Content="Enable"
                                                        FontSize="12"
                                                        Padding="12,3"
                                                        Click="EnableBrowser_Click"
                                                        Tag="{Binding Id}"
                                                        IsEnabled="{Binding CanEnable}" />
                                            </Grid>
                                            <TextBlock x:Name="CharCount"
                                                       FontSize="10"
                                                       Foreground="Red"
                                                       Visibility="{Binding CharCountVisibility}"
                                                       Text="{Binding CharCountText}"
                                                       Margin="0,2,0,0" />
                                        </StackPanel>
                                    </StackPanel>

                                    <Separator Margin="54,0,0,0" />
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Border>

                <!-- Keyboard Shortcuts Section -->
                <TextBlock Text="KEYBOARD SHORTCUTS"
                           FontSize="11" FontWeight="Medium"
                           Foreground="Gray"
                           Margin="4,20,0,8" />

                <Border Background="#0A808080" CornerRadius="10" Padding="12,8">
                    <StackPanel>
                        <Grid Margin="0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="160" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Switch Tabs" FontSize="13" VerticalAlignment="Center" />
                            <Button Grid.Column="1"
                                    x:Name="TabSwitchShortcut"
                                    FontSize="12" FontWeight="Medium"
                                    Height="28"
                                    Click="ShortcutButton_Click"
                                    Tag="tabSwitch" />
                        </Grid>
                        <Separator />
                        <Grid Margin="0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="160" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Copy URL" FontSize="13" VerticalAlignment="Center" />
                            <Button Grid.Column="1"
                                    x:Name="CopyUrlShortcut"
                                    FontSize="12" FontWeight="Medium"
                                    Height="28"
                                    Click="ShortcutButton_Click"
                                    Tag="copyUrl" />
                        </Grid>
                    </StackPanel>
                </Border>

                <Button Content="Reset to Defaults"
                        FontSize="11"
                        Background="Transparent"
                        BorderThickness="0"
                        Foreground="CornflowerBlue"
                        Margin="4,4,0,0"
                        Click="ResetShortcuts_Click"
                        Cursor="Hand"
                        HorizontalAlignment="Left" />
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="1" BorderThickness="0,1,0,0" BorderBrush="LightGray" Padding="24,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        x:Name="CheckUpdatesBtn"
                        Content="Check for Updates..."
                        FontSize="12"
                        Click="CheckUpdates_Click" />

                <Button Grid.Column="2"
                        x:Name="DoneBtn"
                        Content="Done"
                        FontSize="12"
                        Padding="16,4"
                        IsDefault="True"
                        Click="Done_Click" />
            </Grid>
        </Border>
    </Grid>
</Window>
